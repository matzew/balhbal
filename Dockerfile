FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN0cmltemktYXBiCmRlc2NyaXB0aW9uOiBBcGFjaGUgS2Fma2Eg\
Mi4wLjAgb24gS3ViZXJuZXRlcyBhbmQgT3BlblNoaWZ0CmJpbmRhYmxlOiBGYWxzZQphc3luYzog\
b3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IFN0cmltemkgKEFQQikKICBpbWFnZVVy\
bDogImh0dHBzOi8vYXZhdGFyczIuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3UvMzQ3Njc0Mjg/cz0y\
MDAmdj00IgogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwOi8vc3RyaW16aS5pby9kb2NzL21hc3Rl\
ci8iCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCiAgZGVwZW5kZW5jaWVz\
OgogICAgLSAiZG9ja2VyLmlvL3N0cmltemkvdG9waWMtb3BlcmF0b3I6MC43LjAtcmMxIgogICAg\
LSAiZG9ja2VyLmlvL3N0cmltemkvZW50aXR5LW9wZXJhdG9yLXN0dW5uZWw6MC43LjAtcmMxIgog\
ICAgLSAiZG9ja2VyLmlvL3N0cmltemkvdXNlci1vcGVyYXRvcjowLjcuMC1yYzEiCiAgICAtICJk\
b2NrZXIuaW8vc3RyaW16aS9jbHVzdGVyLW9wZXJhdG9yOjAuNy4wLXJjMSIKICAgIC0gImRvY2tl\
ci5pby9zdHJpbXppL2thZmthOjAuNy4wLXJjMSIKICAgIC0gImRvY2tlci5pby9zdHJpbXppL2th\
ZmthLXN0dW5uZWw6MC43LjAtcmMxIgogICAgLSAiZG9ja2VyLmlvL3N0cmltemkva2Fma2EtaW5p\
dDowLjcuMC1yYzEiCiAgICAtICJkb2NrZXIuaW8vc3RyaW16aS96b29rZWVwZXItc3R1bm5lbDow\
LjcuMC1yYzEiCiAgICAtICJkb2NrZXIuaW8vc3RyaW16aS96b29rZWVwZXI6MC43LjAtcmMxIgpw\
bGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBQZXJzaXN0ZW50IGRlcGxv\
eW1lbnQgb2YgQXBhY2hlIEthZmthIG9uIE9wZW5zaGlmdAogICAgZnJlZTogVHJ1ZQogICAgbWV0\
YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJzOgogICAgLSBuYW1lOiBhZG1pbl91c2VyCiAgICAgIHRp\
dGxlOiBPcGVuc2hpZnQgQWRtaW4gVXNlcgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgcmVxdWly\
ZWQ6IHRydWUKICAgIC0gbmFtZTogYWRtaW5fcGFzc3dvcmQKICAgICAgdGl0bGU6IE9wZW5zaGlm\
dCBBZG1pbiBQYXNzd29yZAogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV90eXBlOiBw\
YXNzd29yZAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgLSBuYW1lOiBDTFVTVEVSX05BTUUKICAg\
ICAgdGl0bGU6IE5hbWUgb2YgdGhlIGNsdXN0ZXIKICAgICAgZGVzY3JpcHRpb246IEFsbCBLdWJl\
cm5ldGVzIHJlc291cmNlcyB3aWxsIGJlIG5hbWVkIGFmdGVyIHRoZSBjbHVzdGVyIG5hbWUKICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgIGRlZmF1bHQ6IG15LWNsdXN0ZXIKICAgICAgcmVxdWlyZWQ6\
IHRydWUKICAgIC0gbmFtZTogWk9PS0VFUEVSX05PREVfQ09VTlQKICAgICAgcmVxdWlyZWQ6IFRy\
dWUKICAgICAgZGVmYXVsdDogMQogICAgICB0eXBlOiBpbnQKICAgICAgdGl0bGU6IE51bWJlciBv\
ZiBab29rZWVwZXIgbm9kZXMgaW4gdGhlIHByb2plY3QKICAgIC0gbmFtZTogS0FGS0FfTk9ERV9D\
T1VOVAogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICBkZWZhdWx0OiAxCiAgICAgIHR5cGU6IGlu\
dAogICAgICB0aXRsZTogTnVtYmVyIG9mIEthZmthIG5vZGVzIGluIHRoZSBwcm9qZWN0CiAgICAt\
IG5hbWU6IFpPT0tFRVBFUl9WT0xVTUVfQ0FQQUNJVFkKICAgICAgdGl0bGU6IFpvb2tlZXBlciBW\
b2x1bWUgQ2FwYWNpdHkKICAgICAgZGVzY3JpcHRpb246IFZvbHVtZSBzcGFjZSBhdmFpbGFibGUg\
Zm9yIFpvb2tlZXBlciBkYXRhLCBlLmcuIDFHaSwgMkdpCiAgICAgIHR5cGU6IGVudW0KICAgICAg\
ZGVmYXVsdDogJzFHaScKICAgICAgZW51bTogWycxR2knLCAnMkdpJywgJzVHaSddCiAgICAgIHJl\
cXVpcmVkOiB0cnVlCiAgICAtIG5hbWU6IEtBRktBX1ZPTFVNRV9DQVBBQ0lUWQogICAgICB0aXRs\
ZTogS2Fma2EgVm9sdW1lIENhcGFjaXR5CiAgICAgIGRlc2NyaXB0aW9uOiBWb2x1bWUgc3BhY2Ug\
YXZhaWxhYmxlIGZvciBLYWZrYSBkYXRhLCBlLmcuIDFHaSwgMkdpCiAgICAgIHR5cGU6IGVudW0K\
ICAgICAgZGVmYXVsdDogJzFHaScKICAgICAgZW51bTogWycxR2knLCAnMkdpJywgJzVHaSddCiAg\
ICAgIHJlcXVpcmVkOiB0cnVlCiAgICAtIG5hbWU6IEtBRktBX09GRlNFVFNfVE9QSUNfUkVQTElD\
QVRJT05fRkFDVE9SCiAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgIGRlZmF1bHQ6IDEKICAgICAg\
dHlwZTogaW50CiAgICAgIHRpdGxlOiBUaGUgcmVwbGljYXRpb24gZmFjdG9yIGZvciB0aGUgb2Zm\
c2V0cyB0b3BpYwogICAgLSBuYW1lOiBLQUZLQV9UUkFOU0FDVElPTl9TVEFURV9MT0dfUkVQTElD\
QVRJT05fRkFDVE9SCiAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgIGRlZmF1bHQ6IDEKICAgICAg\
dHlwZTogaW50CiAgICAgIHRpdGxlOiBUaGUgcmVwbGljYXRpb24gZmFjdG9yIGZvciB0aGUgdHJh\
bnNhY3Rpb24gdG9waWMKICAgIC0gbmFtZTogWk9PS0VFUEVSX0hFQUxUSENIRUNLX0RFTEFZCiAg\
ICAgIHRpdGxlOiBab29rZWVwZXIgaGVhbHRoY2hlY2sgaW5pdGlhbCBkZWxheQogICAgICBkZXNj\
cmlwdGlvbjogTnVtYmVyIG9mIHNlY29uZHMgYWZ0ZXIgdGhlIGNvbnRhaW5lciBoYXMgc3RhcnRl\
ZCBiZWZvcmUgaGVhbHRoY2hlY2sgcHJvYmVzIGFyZSBpbml0aWF0ZWQKICAgICAgcmVxdWlyZWQ6\
IHRydWUKICAgICAgZGVmYXVsdDogMTUKICAgICAgdHlwZTogaW50CiAgICAtIG5hbWU6IFpPT0tF\
RVBFUl9IRUFMVEhDSEVDS19USU1FT1VUCiAgICAgIHRpdGxlOiBab29rZWVwZXIgaGVhbHRoY2hl\
Y2sgdGltZW91dAogICAgICBkZXNjcmlwdGlvbjogTnVtYmVyIG9mIHNlY29uZHMgYWZ0ZXIgd2hp\
Y2ggdGhlIHByb2JlIHRpbWVzIG91dAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgICBkZWZhdWx0\
OiA1CiAgICAgIHR5cGU6IGludAogICAgLSBuYW1lOiBLQUZLQV9IRUFMVEhDSEVDS19ERUxBWQog\
ICAgICB0aXRsZTogS2Fma2EgaGVhbHRoY2hlY2sgaW5pdGlhbCBkZWxheQogICAgICBkZXNjcmlw\
dGlvbjogTnVtYmVyIG9mIHNlY29uZHMgYWZ0ZXIgdGhlIGNvbnRhaW5lciBoYXMgc3RhcnRlZCBi\
ZWZvcmUgaGVhbHRoY2hlY2sgcHJvYmVzIGFyZSBpbml0aWF0ZWQKICAgICAgcmVxdWlyZWQ6IHRy\
dWUKICAgICAgZGVmYXVsdDogMTUKICAgICAgdHlwZTogaW50CiAgICAtIG5hbWU6IEtBRktBX0hF\
QUxUSENIRUNLX1RJTUVPVVQKICAgICAgdGl0bGU6IEthZmthIGhlYWx0aGNoZWNrIHRpbWVvdXQK\
ICAgICAgZGVzY3JpcHRpb246IE51bWJlciBvZiBzZWNvbmRzIGFmdGVyIHdoaWNoIHRoZSBwcm9i\
ZSB0aW1lcyBvdXQKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgZGVmYXVsdDogNQogICAgICB0\
eXBlOiBpbnQKICAgIC0gbmFtZTogS0FGS0FfREVGQVVMVF9SRVBMSUNBVElPTl9GQUNUT1IKICAg\
ICAgdGl0bGU6IERlZmF1bHQgcmVwbGljYXRpb24gZmFjdG9yCiAgICAgIGRlc2NyaXB0aW9uOiBE\
ZWZhdWx0IHJlcGxpY2F0aW9uIGZhY3RvciBmb3IgbmV3bHkgY3JlYXRlZCB0b3BpY3MKICAgICAg\
cmVxdWlyZWQ6IHRydWUKICAgICAgZGVmYXVsdDogMQogICAgICB0eXBlOiBpbnQK"



COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
